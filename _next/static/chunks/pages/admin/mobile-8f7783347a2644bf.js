(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6503],{42604:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/mobile",function(){return t(57051)}])},70044:function(e,n){"use strict";n.Z={profileContainer:{display:"flex",flexDirection:"column",width:"100%"},profileCard:{padding:"22px",display:"flex",flexDirection:"column",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"15px",maxWidth:"600px",margin:"auto",borderColor:"#E2E8F0"},textfield:{marginTop:function(e){return e.spacing(3)}},button:{marginTop:function(e){return e.spacing(2)},width:"200px"}}},31338:function(e,n,t){"use strict";t.d(n,{x:function(){return c},P:function(){return u}});var r=t(85893),i=t(87357);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var c=function(e){var n=e.children,t=e.value,c=e.index,u=a(e,["children","value","index"]);return(0,r.jsx)("div",function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){o(e,n,t[n])}))}return e}({role:"tabpanel",hidden:t!==c,id:"custom-tabpanel-".concat(c),"aria-labelledby":"custom-tab-".concat(c)},u,{children:t===c&&(0,r.jsx)(i.Z,{sx:{p:3},children:n})}))};var u=function(e){return{id:"custom-tab-".concat(e),"aria-controls":"custom-tabpanel-".concat(e)}}},57051:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return fe}});var r=t(85893),i=t(66383),o=t(95243),a=t(47426),c=t(34051),u=t.n(c),s=t(31338),l=t(38206),f=t(15861),d=t(87357),p=t(88409),h=t(40044),v=t(94054),b=t(47312),y=t(18360),x=t(18972),m=t(37598),O=t(11057),g=t(98456),j=t(86886),w=t(67294),N=t(9473),I=t(56867),S=t(70044),_=t(57709),P=t(59334),C=t(69368);function Z(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function k(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],a=!0,c=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(u){c=!0,i=u}finally{try{a||null==t.return||t.return()}finally{if(c)throw i}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return Z(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Z(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var A={PaperProps:{style:{maxHeight:224,width:250}}};function T(e){var n=e.municipalities,t=e.setSelectedMun,i=k(w.useState([]),2),o=i[0],a=i[1];return(0,r.jsx)("div",{children:(0,r.jsxs)(v.Z,{sx:{mb:2,width:600},children:[(0,r.jsx)(b.Z,{id:"multiple-checkbox",children:"Municipality"}),(0,r.jsx)(y.Z,{labelId:"multiple-checkbox",id:"multiple-checkbox",multiple:!0,value:o,onChange:function(e){var n=e.target.value;a("string"===typeof n?n.split(","):n),t("string"===typeof n?n.split(","):n)},input:(0,r.jsx)(_.Z,{label:"Municipality"}),renderValue:function(e){return e.join(", ")},MenuProps:A,children:null===n||void 0===n?void 0:n.map((function(e){return(0,r.jsxs)(x.Z,{value:e,children:[(0,r.jsx)(C.Z,{checked:o.includes(e)}),(0,r.jsx)(P.Z,{primary:e})]},e)}))})]})})}var E=t(9669),R=t.n(E),M=t(99431),D=t(94763);function F(e,n,t,r,i,o,a){try{var c=e[o](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,i)}function L(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){F(o,r,i,a,c,"next",e)}function c(e){F(o,r,i,a,c,"throw",e)}a(void 0)}))}}function U(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function W(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,n,t){return n&&W(e.prototype,n),t&&W(e,t),e}function B(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}function z(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&J(e,n)}function H(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){B(e,n,t[n])}))}return e}function X(e,n){return!n||"object"!==Q(n)&&"function"!==typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function J(e,n){return J=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},J(e,n)}var Q=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function $(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=q(e);if(n){var i=q(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return X(this,t)}}var G={BASE_API_URL:"https://amia-cis-9aoz.onrender.com/api",SAVE_NOTIFICATION:"".concat("https://amia-cis-9aoz.onrender.com/api","/notification"),SEND_NOTIFICATION_PROVINCIAL:"".concat("https://notification-api-server.onrender.com","/send-notification-by-province"),SEND_NOTIFICATION_MUNICIPAL:"".concat("https://notification-api-server.onrender.com","/send-notification-by-municipalities"),SEND_NOTIFICATION_PROVINCIAL_LOCAL:"http://localhost:5000/send-notification-by-province",SEND_NOTIFICATION_MUNICIPAL_LOCAL:"http://localhost:5000/send-notification-by-municipalities",SAVE_NOTIFICATION_LOCAL:"http://localhost:3001/api/notification"},K=function(e){z(t,e);var n=$(t);function t(){return U(this,t),n.apply(this,arguments)}return V(t,[{key:"saveNotificationMessage",value:function(e){var n=this;return L(u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"push_notifications",r=n.collection(n.db,"push_notifications"),t.next=4,n.addDoc(r,e);case 4:case"end":return t.stop()}}),t)})))()}}]),t}(D.Z),Y=function(e){z(t,e);var n=$(t);function t(){return U(this,t),n.apply(this,arguments)}return V(t,[{key:"saveNotificationMessage",value:function(e){var n=this;return L(u().mark((function t(){var r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.createRequestObject({body:e});case 2:return r=t.sent,t.next=5,R()(H({},r,{url:G.SAVE_NOTIFICATION,method:"POST"}));case 5:return i=t.sent,t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t)})))()}},{key:"sendNotificationMessageProvincial",value:function(e){var n=this;return L(u().mark((function t(){var r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("URL",G.SEND_NOTIFICATION_PROVINCIAL),t.next=3,n.createRequestObjectNotif({body:e});case 3:return r=t.sent,t.next=6,R()(H({},r,{url:G.SEND_NOTIFICATION_PROVINCIAL,method:"POST"}));case 6:return i=t.sent,t.abrupt("return",i.data);case 8:case"end":return t.stop()}}),t)})))()}},{key:"sendNotificationMessageMunicipal",value:function(e){var n=this;return L(u().mark((function t(){var r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("URL",G.SEND_NOTIFICATION_MUNICIPAL),t.next=3,n.createRequestObjectNotif({body:e});case 3:return r=t.sent,t.next=6,R()(H({},r,{url:G.SEND_NOTIFICATION_MUNICIPAL,method:"POST"}));case 6:return i=t.sent,t.abrupt("return",i.data);case 8:case"end":return t.stop()}}),t)})))()}}]),t}(M.Z),ee=new Y,ne=new K,te=ne.saveNotificationMessage.bind(ne),re=ee.sendNotificationMessageMunicipal.bind(ee),ie=ee.sendNotificationMessageProvincial.bind(ee),oe=t(8465),ae=t(4936);function ce(e,n,t,r,i,o,a){try{var c=e[o](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,i)}function ue(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function se(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){ue(e,n,t[n])}))}return e}var le=function(){var e=(0,N.I0)(),n=(0,w.useState)(0),t=n[0],i=n[1],o=(0,w.useState)(null),a=o[0],c=o[1],_=(0,w.useState)([]),P=_[0],C=_[1],Z=(0,w.useState)(null),k=Z[0],A=Z[1],E=(0,w.useState)(null),R=E[0],M=E[1],D=(0,w.useState)(null),F=D[0],L=D[1],U=(0,w.useState)([]),W=U[0],V=U[1],B=(0,w.useState)(!1),q=B[0],z=B[1],H=(0,w.useState)(!1),X=H[0],J=H[1],Q=(0,w.useState)(null),$=Q[0],G=Q[1],K=(0,w.useState)("weather_advisory"),Y=K[0],ee=K[1],ne=(0,w.useState)(null),ue=ne[0],le=ne[1],fe="\ud83c\udf31 10-Day Farm Weather Outlook is ready!\n\n  Based on the forecast for ".concat(ue,", a new recommendation is\n  available to help improve your farm\u2019s resilience to changing\n  weather conditions.\n\n  Read these practices to make informed decisions and reduce climate-related risks.\n\n  Click the green button to read.\n  "),de=(0,N.v9)((function(e){return e.tendayweather})).entities,pe=(0,N.v9)((function(e){return e.provinces})),he=pe.ids,ve=pe.municipalities;(0,w.useEffect)((function(){if(0===he.length&&0===ve.length)e((0,ae.Q)());else{var n=Object.keys(ve);C(n)}}),[e,ve,he.length]),(0,w.useEffect)((function(){null!==k&&L(ve[k].map((function(e){return e.label})))}),[k,e,ve]),(0,w.useEffect)((function(){var e,n;if(de){var t=null===(n=null===(e=Object.values(de).map((function(e){return{data:JSON.parse(null===e||void 0===e?void 0:e.data)}}))[0])||void 0===e?void 0:e.data[0])||void 0===n?void 0:n.date_range;le(t)}}),[de]);var be=function(){var e,n=(e=u().mark((function e(){var n,t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z(!0),(n={body:"tenday"===Y?fe:"rscoa"===Y?"RSCOA Message":a,province:k,municipalities:W||void 0,deliveryType:R,date_created:Math.floor(Date.now()/1e3),notifType:Y,dateRange:ue}).notifType&&n.body&&n.province){e.next=6;break}return console.warn("INFO: Missing parameters!"),z(!1),e.abrupt("return");case 6:if(e.prev=6,"municipal"!==R){e.next=14;break}return e.next=11,re(n);case 11:t=e.sent,e.next=18;break;case 14:if("provincial"!==R){e.next=18;break}return e.next=17,ie(n);case 17:t=e.sent;case 18:if(!t.success){e.next=24;break}return e.next=21,te(n);case 21:G("Notification sent!"),e.next=25;break;case 24:console.warn("ERROR: Message not save"),G("Notification not archived!");case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(6),console.warn("ERROR: Error sending push notification!",e.t0),G("Error sending push notification!");case 31:return e.prev=31,z(!1),J(!0),e.finish(31);case 35:case"end":return e.stop()}}),e,null,[[6,27,31,35]])})),function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){ce(o,r,i,a,c,"next",e)}function c(e){ce(o,r,i,a,c,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,r.jsxs)("div",{children:[(0,r.jsx)(oe.Z,{open:X,autoHideDuration:3e3,onClose:function(e,n){"clickaway"!==n&&J(!1)},children:(0,r.jsx)(l.Z,{style:{backgroundColor:"white",color:"blue"},message:(0,r.jsxs)("span",{id:"client-snackbar",children:[" ",$," "]})})}),(0,r.jsx)(f.Z,{variant:"h5",children:"Mobile App Management"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:" Trigger push notifications"})," of generated Crop Recommendations, Weather Updates and send them to different individuals via Mobile Application."]}),(0,r.jsx)(d.Z,{sx:S.Z.tabsContainer,children:(0,r.jsxs)(d.Z,{sx:S.Z.tabsContainer,children:[(0,r.jsx)(p.Z,{value:t,onChange:function(e,n){i(n)},"aria-label":"Tabs",children:(0,r.jsx)(h.Z,se({label:"Send Notification"},(0,s.P)(0)))}),(0,r.jsxs)(d.Z,{children:[(0,r.jsxs)(s.x,{value:t,index:0,children:[(0,r.jsxs)(d.Z,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)(v.Z,{sx:{width:600,mb:2},children:[(0,r.jsx)(b.Z,{id:"notif-type",children:" Notification Type "}),(0,r.jsxs)(y.Z,{labelId:"notif-type",id:"notif-type",value:Y,label:"Notification Type",onChange:function(e){c(null),ee(e.target.value)},children:[(0,r.jsx)(x.Z,{value:"weather_update",children:" Weather Advisory "}),(0,r.jsx)(x.Z,{value:"mindanao_weather_update",children:" Mindanao Weather Forecast "}),(0,r.jsx)(x.Z,{value:"tenday",children:" 10-Day FWOA "}),(0,r.jsx)(x.Z,{value:"rscoa",children:" RSCOA "}),(0,r.jsx)(x.Z,{value:"system_updates",children:" System Updates "})]})]}),(0,r.jsxs)(v.Z,{sx:{width:600,mb:2},children:[(0,r.jsx)(b.Z,{id:"delivery-type",children:" Delivery Type "}),(0,r.jsxs)(y.Z,{labelId:"delivery-type",id:"delivery-type",value:R,label:"Delivery Type",onChange:function(e){M(e.target.value)},children:[(0,r.jsx)(x.Z,{value:"provincial",children:"Send notification by province"}),(0,r.jsx)(x.Z,{value:"municipal",children:"Send notification by municipality"})]})]}),(0,r.jsxs)(v.Z,{sx:{width:600,mb:2},children:[(0,r.jsx)(b.Z,{id:"select-province",children:" Select Province "}),(0,r.jsx)(y.Z,{labelId:"select-province",id:"select-province",value:k,label:"Select Province",onChange:function(n){A(n.target.value),e((0,I.R)(n.target.value))},children:null===P||void 0===P?void 0:P.map((function(e,n){return(0,r.jsxs)(x.Z,{value:e,children:[" ",e," "]},n)}))})]}),"municipal"===R&&(0,r.jsx)(T,{municipalities:F,setSelectedMun:V}),(0,r.jsx)(m.Z,{"aria-label":"minimum height",minRows:10,placeholder:"Notification body",style:{width:600},onChange:function(e){c(e.target.value)},value:"tenday"===Y?fe:"rscoa"===Y?"RSCOA Message":a}),(0,r.jsx)(O.Z,{onClick:be,disabled:q,variant:"contained",sx:{width:300,m:2},children:!0===q?(0,r.jsxs)(r.Fragment,{children:[" Sending...",(0,r.jsx)(g.Z,{color:"secondary"})," "]}):"Send Notification"})]}),(0,r.jsx)(d.Z,{sx:{width:"100%",display:"flex"}})]}),(0,r.jsx)(s.x,{value:t,index:1,children:(0,r.jsx)(j.ZP,{container:!0,children:(0,r.jsx)(j.ZP,{item:!0,xs:12,md:4})})})]})]})})]})};var fe=(0,o.Z)((function(e){return(0,r.jsx)(i.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:a.DW.ADMIN,children:(0,r.jsx)(le,{})})}))}},function(e){e.O(0,[5778,3593,9964,6002,6223,6279,7530,8465,6572,2460,1050,9774,2888,179],(function(){return n=42604,e(e.s=n);var n}));var n=e.O();_N_E=n}]);