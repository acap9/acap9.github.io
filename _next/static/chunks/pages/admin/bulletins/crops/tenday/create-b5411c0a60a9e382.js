(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5507],{67947:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/tenday/create",function(){return t(8822)}])},55688:function(e,n,t){"use strict";var r=t(85893),i=t(67294),o=t(45697),a=t.n(o),l=t(14866),s=t(46901);function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var u=i.forwardRef((function(e,n){return(0,r.jsx)(s.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){c(e,n,t[n])}))}return e}({elevation:6,ref:n,variant:"filled"},e))}));function p(e){var n=e.openSnackbar,t=e.message,o=e.severity,a=e.closeHandlerCB,s=void 0===a?function(){}:a,c=(0,i.useState)(n),p=c[0],d=c[1];(0,i.useEffect)((function(){d(n)}),[n]);var f=function(){d(!1),s()};return(0,r.jsx)(l.Z,{open:p,autoHideDuration:3e3,onClose:f,children:(0,r.jsx)(u,{onClose:f,severity:o,sx:{width:"100%"},children:t})})}p.propTypes={openSnackbar:a().bool,message:a().string,severity:a().string},n.Z=p},19247:function(e,n){"use strict";n.Z={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",borderColor:"#E2E8F0"},welcome:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},width:"100%",display:"grid",placeContent:"center",padding:"20px",marginTop:function(e){return e.spacing(1)},textAlign:"center","& h6":{lineHeight:"20px"}},summary:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},marginTop:function(e){return e.spacing(1)},padding:function(e){return e.spacing(3)}},selectionSummary:{minWidth:"100%",paddingLeft:{xs:0,lg:"16px"}},conditionLegend:{borderRadius:function(e){return e.spacing(1)},width:"100%",padding:function(e){return e.spacing(1)},border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",float:"left"},autocomplete:{marginTop:function(e){return e.spacing(1)}},recSeasonal:{marginTop:function(e){return e.spacing(1)},"& p, ul, ol":{fontSize:"14px"}},button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"50px"}},pdfcontent:{ul:{paddingLeft:3}},recSeasonalStage:{marginTop:function(e){return e.spacing(5)},marginBottom:function(e){return e.spacing(2)},textDecoration:"underline"}}},8822:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return be}});var r=t(34051),i=t.n(r),o=t(85893),a=t(67294),l=t(9473),s=t(11163),c=t(45697),u=t.n(c),p=t(41664),d=t(21023),f=t(76295),m=t(11057),g=t(56863),v=t(87357),b=t(86886),h=t(93946),y=t(61903),x=t(15861),_=t(11829),j=t(19227),S=t(22094),w=t(98456),O=t(67720),Z=t(40044),E=t(88409),k=t(901),P=t(24478),C=t(22228),D=t(19247);function T(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function F(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){T(e,n,t[n])}))}return e}function I(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function R(e){var n=function(e){var n=e.children,t=e.value,r=e.index,i=I(e,["children","value","index"]);return(0,o.jsx)("div",F({role:"tabpanel",hidden:t!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},i,{children:t===r&&(0,o.jsx)(v.Z,{sx:{p:3,whiteSpace:e.smsstyle},children:n})}))},t=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},r=e.options,i=e.smstext,s=e.sel_options,c=e.optsactivities,u=e.recommendationsData,d=e.loading,f=e.handleSave,h=e.handlePreview,y=e.show,_=void 0===y||y,j=e.isCreateDisabled,S=void 0!==j&&j,T=(0,l.v9)((function(e){return e.recommendations})),R=T.filtered_recommendations,A=T.recommendations,B=(0,C.Z)(null!==u&&void 0!==u?u:A,c).group,L=(0,l.v9)((function(e){return e.reports})),M=L.error,N=L.status,z=(0,l.v9)((function(e){return e.dashboard.isEnglish})),W=(0,a.useState)(0),G=W[0],H=W[1],V=(0,a.useState)(!1),U=V[0],Y=V[1];(0,a.useEffect)((function(){Y(r.loading||N===k.G.PENDING)}),[r.loading,N]);return(0,o.jsxs)(b.ZP,{container:!0,sx:D.Z.container,gap:3,style:{marginTop:"24px",padding:d?"16px":"24px"},children:[(0,o.jsxs)(b.ZP,{item:!0,sx:D.Z.item,xs:12,lg:12,children:[(0,o.jsx)(v.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,o.jsx)(w.Z,{size:16,color:"primary",sx:{display:d?"block":"none"}})}),null!==R&&_&&(0,o.jsx)(v.Z,{children:(0,o.jsxs)(v.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"}},children:[(0,o.jsx)(v.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,o.jsxs)(E.Z,{value:G,onChange:function(e,n){H(n)},"aria-label":"basic tabs example",children:[(0,o.jsx)(Z.Z,F({label:"PDF FORM"},t(0))),(0,o.jsx)(Z.Z,F({label:"SMS FORM"},t(1)))]})}),(0,o.jsxs)(n,{value:G,index:0,smsstyle:"normal",children:[(0,o.jsx)(v.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"}}),(0,o.jsx)(v.Z,{sx:D.Z.recSeasonal,children:(0,o.jsx)(P.Z,{isBulletin:!0,impactOutlookOnly:!0,isShowImpactOutlookSubtitle:!1,recommendations:B,impactOutlookEng:"impact",impactOutlookTag:"impact_tagalog",title:s.sel_crop,isTagalog:!z,isShowTitle:!1})}),(0,o.jsx)(x.Z,{variant:"h4",sx:{marginTop:"32px"},children:"Recommendations"}),Object.keys(R).map((function(e){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.Z,{variant:"h5",sx:D.Z.recSeasonalStage,children:e}),Object.keys(R[e]).map((function(n,t){return(0,o.jsxs)(v.Z,{sx:F({},D.Z.recSeasonal,{marginBottom:"24px","& h6":{color:"rgba(0, 0, 0, 0.67)"}}),children:[(0,o.jsx)(x.Z,{variant:"h6",children:n}),(0,o.jsx)(P.Z,{isBulletin:!0,recommendations:R[e][n],isTagalog:!z,isShowTitle:!1})]},"rec-".concat(t))}))]})}))]}),(0,o.jsx)(n,{value:G,index:1,smsstyle:"pre-wrap",children:i})]})})]}),(0,o.jsxs)(v.Z,{sx:{marginBottom:"16px",width:"100%",display:null!==R&&_?"block":"none"},children:[(0,o.jsx)("br",{}),(0,o.jsx)(O.Z,{}),(0,o.jsx)("br",{}),""!==M&&(0,o.jsxs)(x.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",M]}),(0,o.jsxs)(g.Z,{size:"large","aria-label":"large button group",sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,o.jsx)(p.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,o.jsx)(m.Z,{disabled:U,children:"Cancel"})}),(0,o.jsxs)(m.Z,{onClick:h,disabled:U,children:[(0,o.jsx)("span",{style:{display:U?"none":"block"},children:"Preview"})," ","\xa0",(0,o.jsx)(w.Z,{size:20,color:"secondary",sx:{display:U?"block":"none"}})]}),(0,o.jsx)(m.Z,{variant:"contained",onClick:f,disableElevation:!0,disabled:U||S,children:"Save"})]})]})]})}R.propTypes={options:u().object,smstext:u().string,keyEng:u().string,keyTag:u().string,formTitle:u().string,isCreateDisabled:u().bool,show:u().bool,loading:u().bool,handleSave:u().func,handlePreview:u().func};var A=R,B=t(79316),L=t(55688),M=t(12671),N=t(22757);function z(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function W(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){z(e,n,t[n])}))}return e}function G(e){var n=(0,a.useState)(!1),t=n[0],r=n[1],i=(0,s.useRouter)(),c=(0,l.I0)(),u=e.open,w=e.loading,O=e.isloadingreport,Z=e.isdisabled,E=e.climateRisk,k=e.optsprovinces,P=e.optsmunicipalities,C=e.optscrops,D=e.optscropstages,T=e.optsactivities,F=e.recommendationsData,I=e.sel_options,R=e.message,z=e.smstext,G=e.pageTitle,H=void 0===G?"":G,V=e.pageDescription,U=void 0===V?"":V,Y=e.pdfPreview,q=e.handlePreview,K=e.handleSave,$=e.resetSelections,X=e.togglePrompt,J=e.toggleViewerOpen,Q=e.onSelectItemChange,ee=(0,l.v9)((function(e){return e.reports})).report,ne="Invalid year";(0,a.useEffect)((function(){null===I.sel_municipality&&!0===t&&r(!1)}),[I.sel_municipality,t]);var te=function(){ee&&(c((0,M.s_)()),i.push("/admin/bulletins/crops/report/view/?docId=".concat(ee.id)))},re=function(){var e="Loading...";return k.length>0&&(e=null===I.sel_province?"Select a province":"Province"),e};return(0,o.jsxs)("div",{children:[(0,o.jsx)(j.Z,{isOpen:R.isOpen,maxWidth:"xs",openButtonText:null,title:R.title,contentText:R.msg,loading:R.loading,modalCancelHandlerCB:function(){R.savesuccess?te():X()},modalConfirmHandlerCB:function(){R.savesuccess?te():K()}}),(0,o.jsx)(S.Z,{open:u,pdfPreview:Y,error:I.error,loading:I.loading,toggleViewerOpen:J}),(0,o.jsx)(L.Z,{openSnackbar:""!==I.error,message:I.error,severity:"warning"}),(0,o.jsxs)(b.ZP,{container:!0,sx:N.Z.container,children:[(0,o.jsxs)(v.Z,{sx:N.Z.headerText,children:[(0,o.jsxs)(v.Z,{children:[(0,o.jsx)(x.Z,{variant:"h5",children:H}),(0,o.jsx)("p",{dangerouslySetInnerHTML:{__html:U}})]}),(0,o.jsx)(v.Z,{children:(0,o.jsx)(h.Z,{"aria-label":"exit",size:"medium",children:(0,o.jsx)(p.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,o.jsx)(d.Z,{fontSize:"inherit"})})})})]}),(0,o.jsxs)(b.ZP,{item:!0,sx:N.Z.item,xs:12,lg:4,children:[(0,o.jsx)(x.Z,{variant:"h6",children:"Selection Options"}),(0,o.jsx)(f.Z,{disablePortal:!0,id:"province",size:"small",value:I.sel_province,disabled:0===k.length||I.error.includes(ne)||w,options:k,sx:N.Z.autocomplete,PaperComponent:_.Z,renderInput:function(e){return(0,o.jsx)(y.Z,W({},e,{label:re()}))},getOptionDisabled:function(e){return e.disabled},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){return Q(e,W({},n,{from:"province"}))}}),(0,o.jsx)(f.Z,{disablePortal:!0,id:"municipality",size:"small",value:I.sel_municipality,disabled:0===P.length||I.error.includes(ne)||w,options:P,sx:N.Z.autocomplete,PaperComponent:_.Z,renderInput:function(e){return(0,o.jsx)(y.Z,W({},e,{label:null===I.sel_municipality?"Select a municipality":"Municipality"}))},getOptionDisabled:function(e){return e.disabled||void 0!==e.iscalendar},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){Q(e,W({},n,{from:"municipality"})),r(!1)}}),(0,o.jsx)(f.Z,{disablePortal:!0,id:"crop",size:"small",value:I.sel_crop,disabled:0===C.length||w||!I.sel_municipality,options:C,sx:N.Z.autocomplete,PaperComponent:_.Z,renderInput:function(e){return(0,o.jsx)(y.Z,W({},e,{label:null===I.sel_crop?"Select a crop type":"Crop"}))},isOptionEqualToValue:function(e,n){return e.label===n},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){Q(e,W({},n,{from:"crop"})),r(!1)}}),null!==I.sel_municipality&&(0,o.jsxs)("div",{style:{marginTop:"16px",float:"left",textAlign:"center",border:"1px solid #DCEDC8",padding:"5px 10px",borderRadius:"5px"},children:[(0,o.jsx)(x.Z,{variant:"subtitle1",children:(0,o.jsx)("strong",{children:"Climate Risk:"})}),E]}),(0,o.jsxs)(g.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:O||null===I.sel_municipality||"-"===I.sel_crop,sx:{marginTop:"16px",float:"right"},children:[(0,o.jsx)(m.Z,{variant:"outlined",disabled:w||O,onClick:$,children:"Reset"}),(0,o.jsx)(m.Z,{variant:"contained",onClick:function(){return r((function(e){return!e}))},disabled:w||null===I.sel_month||0===D.length||""!==I.error||t,children:"Generate"})]})]}),(0,o.jsx)(b.ZP,{item:!0,sx:N.Z.item,xs:12,lg:8,children:(0,o.jsx)(B.Z,{climateRisk:E,selecteditems:I,cropstages:null===D||void 0===D?void 0:D.map((function(e){return e.label})).toString().split(",").join(", "),farmoperations:T.map((function(e){return e.label})).toString().split(",").join(", "),loading:w,reportType:"Special Weather Bulletin"===H?"special":"tenday"})})]}),(0,o.jsx)(A,{show:t,loading:w,keyEng:"practice",keyTag:"practice_tagalog",sel_options:I,recommendationsData:F,optsactivities:T,options:I,smstext:z,isCreateDisabled:Z,handlePreview:q,toggleViewerOpen:J,pdfPreview:Y,handleSave:X})]})}G.propTypes={climateRisk:u().string,optsprovinces:u().array,optsmunicipalities:u().array,optscrops:u().array,optscropstages:u().array,optsactivities:u().array,sel_options:u().object,loading:u().bool,isloadingreport:u().bool,isdisabled:u().bool,open:u().bool,message:u().object,smstext:u().string,pageTitle:u().string,pageDescription:u().string,pdfPreview:u().object,onSelectItemChange:u().func,handlePreview:u().func,handleSave:u().func,toggleViewerOpen:u().func,resetSelections:u().func,togglePrompt:u().func};var H=G,V=t(66383),U=t(95243),Y=t(16327),q=t(61690),K=t(87006),$=t(72216),X=t(59390),J=t(38885),Q=t(22856),ee=t(27941),ne=t(23766),te=t(15497),re=t(94640),ie=t(27392),oe=t(59111),ae=t(77715),le=t(47426),se=t(53063),ce=t(87784),ue=t(52955);function pe(e,n,t,r,i,o,a){try{var l=e[o](a),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(r,i)}function de(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){pe(o,r,i,a,l,"next",e)}function l(e){pe(o,r,i,a,l,"throw",e)}a(void 0)}))}}function fe(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function me(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){fe(e,n,t[n])}))}return e}var ge={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:[],sel_month:null,processed:!1,loading:!1,error:"",success:"",sel_condition:{id:0,from:"weather_condition",label:le.MW.WAY_BELOW_NORMAL.label}},ve={url:"",filename:""};var be=(0,U.Z)((function(e){var n=e.user,t=e.onBtnLogoutClick,r=e.loading,s=(0,a.useState)(ge),c=s[0],u=s[1],p=(0,a.useState)({}),d=p[0],f=p[1],m=(0,a.useState)({}),g=m[0],v=m[1],b=(0,a.useState)([]),h=b[0],y=b[1],x=(0,a.useState)([]),_=x[0],j=x[1],S=(0,a.useState)([]),w=S[0],O=S[1],Z=(0,a.useState)([]),E=Z[0],P=Z[1],C=(0,ne.Z)(c.sel_province,w),D=(0,re.Z)(c.sel_province,c.sel_municipality),T=D.days,F=D.loading,I=D.summary;(0,a.useEffect)((function(){if(T.length>0){var e=(0,ue.Z)(T,"tenday"),n=me({},e);["Flooding/Submergence 3M","Flooding/Submergence 2H"].includes(n.label)&&(e.label="Flooding/Submergence",e.code="flood_submergence"),f(e),v(n)}}),[T]);var R=(0,X.Z)(c.sel_province,c.sel_crop),A=R.cropcalendar,B=R.cropStages,L=R.loading,N=(0,J.Z)().cropList.map((function(e,n){return{disabled:!1,label:e,id:n}})),z=(0,Q.Z)(d.code,E,c.sel_crop,"tenday",!0),W=z.recommendations,G=z.farmoperations,U=z.loading,pe=(0,ee.Z)(c.sel_crop,g.code,"tenday_sms"),fe=pe.recommendationsSMS,be=pe.loading,he=(0,te.Z)(W,B,E),ye=he.group,xe=he.error;(0,a.useEffect)((function(){if(T.length>0&&!L&&!U){var e=new Date(T[0].label_full),n=(0,ae.Mn)(e);if(0!==A.length){var t=A.data1.find((function(e){return e.municipality===c.sel_municipality&&e.crop===c.sel_crop})),r=A.data2.find((function(e){return e.municipality===c.sel_municipality&&e.crop===c.sel_crop})),i=[];if(t&&r&&Object.keys(B).length>0){Object.keys(n).forEach((function(e){var o=t[e].split(",");n[e].forEach((function(e){"1st_half"===e&&"none"!==o[0]?i.includes(o[0])||i.push(o[0]):"2nd_half"===e&&"none"!==o[1]&&(i.includes(o[1])||i.push(o[1]))}));var a=r[e].split(",");n[e].forEach((function(e){"1st_half"===e&&"none"!==a[0]?i.includes(a[0])||i.push(a[0]):"2nd_half"===e&&"none"!==a[1]&&(i.includes(a[1])||i.push(a[1]))}))}));var o=i.map((function(e,n){return{id:n,label:B[e].label,code:e}}));P(o)}}}}),[B,A.length,A.data1,A.data2,T,c.sel_municipality,c.sel_crop,L,U]);var _e=(0,l.v9)((function(e){return e.reports})),je=_e.status,Se=_e.report,we=(0,l.v9)((function(e){return e.dashboard.reportType})),Oe=(0,l.v9)((function(e){return e.dashboard.isEnglish})),Ze=(0,a.useState)(!0),Ee=Ze[0],ke=Ze[1],Pe=(0,a.useState)(!1),Ce=Pe[0],De=Pe[1],Te=(0,a.useRef)(!1),Fe=(0,a.useState)(""),Ie=Fe[0],Re=Fe[1],Ae=(0,a.useState)(ve),Be=Ae[0],Le=Ae[1],Me=(0,a.useState)(ie.BF),Ne=Me[0],ze=Me[1],We=(0,l.I0)();(0,a.useEffect)((function(){Te.current=!0;var e=function(){var e=de(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Y.$m)();case 3:n=e.sent,Te&&O(n.data),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return e(),function(){Te.current=!1}}),[]),(0,a.useEffect)((function(){We((0,$.Km)([])),We((0,M.s_)())}),[We]),(0,a.useEffect)((function(){w.length>0&&j((0,oe.m)(w))}),[w]),(0,a.useEffect)((function(){null!==I&&u((function(e){return me({},e,{sel_month:{label:I.date_range}})}))}),[I]),(0,a.useEffect)((function(){ke(r||U||L||F||be)}),[r,U,L,F,be]),(0,a.useEffect)((function(){Le(ve)}),[Oe]),(0,a.useEffect)((function(){0!==fe.length&&Re(fe[0].sms.replace("{{10_day_range_identifier}}",c.sel_month.label))}),[fe,c.sel_month]),(0,a.useEffect)((function(){je===k.G.FULLFILLED&&null!==Se&&Te.current&&ze((function(e){return me({},e,{msg:"Success! Bulletin report created.",loading:!1,savesuccess:!0,docId:Se.id})}))}),[je,Se]),(0,a.useEffect)((function(){xe||null===ye||We((0,$.Km)(ye))}),[ye,xe,We]);var Ge=function(){var e=de(i().mark((function e(){var n,t,r,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===Be.url){e.next=3;break}return De(!0),e.abrupt("return");case 3:return u((function(e){return me({},e,{loading:!0,error:"",success:""})})),e.prev=4,n={region:"zampen",province:c.sel_province,municipality:c.sel_municipality,operation:"preview",language:Oe?"en":"tag",crop:null===c||void 0===c?void 0:c.sel_crop},De(!0),u((function(e){return me({},e,{loading:!0,error:""})})),e.next=10,(0,K.bM)(n);case 10:t=e.sent,r=new Blob([t],{type:"application/pdf"}),(o={}).href=URL.createObjectURL(r),o.download="".concat(c.sel_province,"_").concat(c.sel_municipality,".pdf"),Le((function(e){return me({},e,{url:o.href,filename:o.download})})),u((function(e){return me({},e,{loading:!1,success:"Bulletin preview created."})})),e.next=25;break;case 19:return e.prev=19,e.t0=e.catch(4),e.next=23,(0,ce.fu)(e.t0);case 23:a=e.sent,u((function(e){return me({},e,{loading:!1,error:a})}));case 25:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(){return e.apply(this,arguments)}}(),He=function(){var e=de(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ze(me({},Ne,{loading:!0,msg:"Saving report..."}));try{t={region:"zampen",province:c.sel_province,municipality:c.sel_municipality,operation:"create",language:Oe?"en":"tag",crop:c.sel_crop},We((0,q.a0)(t)).unwrap().then((function(){we!==ie.Ry.TEN_DAY&&(We((0,se.uq)(ie.Ry.TEN_DAY)),We((0,q.RC)({uid:n.uid,type:ie.Ry.TEN_DAY})))})).catch((function(e){Te.current&&ze((function(n){return me({},n,{msg:e,loading:!1,savesuccess:!1,docId:null})}))}))}catch(o){r="",void 0!==o.response&&(r=void 0!==o.response.data&&"[object Blob]"===((i=o.response.data)&&"undefined"!==typeof Symbol&&i.constructor===Symbol?"symbol":typeof i)?o.response.data:""),""===r&&(r=o.message),u((function(e){return me({},e,{loading:!1,error:r})}))}case 2:case"end":return e.stop()}var i}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.jsx)(V.Z,{loading:r,user:n,onBtnLogoutClick:t,accLevel:le.DW.ADMIN,children:(0,o.jsx)(H,{climateRisk:d.label,optsprovinces:_,optsmunicipalities:C,optscrops:N,optscropstages:E,optsactivities:G,sel_options:c,loading:Ee,recommendationsData:W,isloadingreport:je===k.G.PENDING,isdisabled:!1,open:Ce,message:Ne,smstext:Ie,pageTitle:"10-Day Farm Weather Outlook and Advisory Bulletin",pageDescription:"Create <strong>10-Day Farm Weather Outlook and Advisory</strong> crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download.",pdfPreview:Be,onSelectItemChange:function(e,n){var t=n.from,r=n.label;if(Le(ve),h.length>0&&y([]),""!==c.error&&u((function(e){return me({},e,{error:""})})),Object.keys(n).includes("id"))switch(t){case"province":P([]),u((function(e){return me({},e,{sel_province:r,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:null})}));break;case"municipality":P([]),u((function(e){return me({},e,{sel_municipality:r,sel_crop:null,sel_stage:null,sel_activity:null})}));break;case"crop":u((function(e){return me({},e,{sel_crop:r,sel_stage:null,sel_activity:null})})),P([])}else if("province"===t){var i=c.sel_month;u(me({},ge,{sel_month:i})),P([])}else"municipality"===t&&(u(me({},c,{sel_municipality:null,sel_crop:null,sel_day:null,sel_stage:null,sel_activity:null})),P([]))},handlePreview:Ge,handleSave:He,toggleViewerOpen:function(){De((function(e){return!e}))},resetSelections:function(){var e=c.sel_month;u(me({},ge,{sel_month:e})),P([]),We((0,$.Km)([]))},togglePrompt:function(){ze((function(e){return me({},ie.BF,{isOpen:!e.isOpen})}))}})})}))},22228:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e){var n=(0,r.useState)([]),t=n[0],o=n[1],a=(0,r.useState)(""),l=a[0],s=a[1];(0,r.useEffect)((function(){if(s(""),(null===e||void 0===e?void 0:e.length)>0)try{var n=e.map((function(e){return{impact:e.impact_outlook_english,impact_tagalog:e.impact_outlook_tagalog}})).filter((function(e){return""!==e.impact_outlook_english&&""!==e.impact_outlook_tagalog}));return n=u(n),void o([{impact:c(n.impact),impact_tagalog:c(n.impact_tagalog)}])}catch(t){s(t)}else o([])}),[e]);var c=function(e){var n="-",t=e.reduce((function(e,t){return t.includes("<p>")?("list"===n&&(e+="</ul>"),e+=t,n="p"):(["-","p"].includes(n)&&(e+="<ul>"),e+=t,n="list"),e}),"");return"list"===n&&(t+="</ul>"),t},u=function(e){var n={impact:[],impact_tagalog:[]};return e.reduce((function(e,t){return Object.keys(e).forEach((function(r){var i=t[r].replace(/<ul>/g,"");(i=(i=i.replace(/<\/ul>/g,"")).replace(/<li>/g,"")).split("</li>").forEach((function(t){t.includes("<p>")?t.replace(/<p>/g,"").split("</p>").forEach((function(t){n[r].includes(t)||""===t||(n[r].push(t),e[r].push("<p>".concat(t,"</p>")))})):n[r].includes(t)||""===t||(n[r].push(t),e[r].push("<li>".concat(t,"</li>")))}))})),function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){i(e,n,t[n])}))}return e}({},e)}),{impact:[],impact_tagalog:[]})};return{group:t,error:l}}},15497:function(e,n,t){"use strict";t.d(n,{Z:function(){return a}});var r=t(67294);function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return i(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,n,t){var i=(0,r.useState)(null),a=i[0],l=i[1],s=(0,r.useState)(""),c=s[0],u=s[1];return(0,r.useEffect)((function(){if(u(""),(null===e||void 0===e?void 0:e.length)>0&&(null===t||void 0===t?void 0:t.length)>0&&n){var r=e.map((function(e){return e.farming_activity})).filter((function(e,n,t){return t.indexOf(e)===n})),i=null===t||void 0===t?void 0:t.map((function(e){return e.code}));try{l(i.reduce((function(t,i){return null===r||void 0===r||r.forEach((function(r){var a=n[i].label,l=e.filter((function(e){return e.crop_stage===i&&e.farming_activity===r}));l.length>0&&a&&(void 0===t[a]&&(t[a]={}),void 0===t[a][r]&&(t[a][r]=[]),t[a][r]=o(t[a][r]).concat(o(l)))})),t}),{}))}catch(a){l(null),u(a)}}else l(null)}),[e,n,t]),{group:a,error:c}}},27941:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(34051),i=t.n(r),o=t(67294),a=t(1096);function l(e,n,t,r,i,o,a){try{var l=e[o](a),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(r,i)}function s(e,n,t){var r=(0,o.useState)([]),s=r[0],c=r[1],u=(0,o.useState)(!1),p=u[0],d=u[1],f=(0,o.useState)(""),m=f[0],g=f[1];return(0,o.useEffect)((function(){var r=function(){var r,o=(r=i().mark((function r(){var o,l,s,u;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,o=[],d(!1),g(""),r.next=6,(0,a.iR)({crop:e,climateRisk:n,type:t});case 6:o=r.sent,d(!1),c(o||[]),r.next=18;break;case 11:r.prev=11,r.t0=r.catch(0),u=null!==(s=null===r.t0||void 0===r.t0||null===(l=r.t0.response)||void 0===l?void 0:l.data)&&void 0!==s?s:r.t0.message,g(u),d(!1);case 18:case"end":return r.stop()}}),r,null,[[0,11]])})),function(){var e=this,n=arguments;return new Promise((function(t,i){var o=r.apply(e,n);function a(e){l(o,t,i,a,s,"next",e)}function s(e){l(o,t,i,a,s,"throw",e)}a(void 0)}))});return function(){return o.apply(this,arguments)}}();e&&t?r():c([])}),[e,n,t]),{recommendationsSMS:s,loading:p,error:m}}},94640:function(e,n,t){"use strict";t.d(n,{Z:function(){return p}});var r=t(67294),i=t(9473),o=t(47426),a=t(56867),l=t(77715),s=t(901);function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function u(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return c(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return c(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,n){var t=(0,r.useState)([]),c=t[0],p=t[1],d=(0,r.useState)(null),f=d[0],m=d[1],g=(0,r.useState)(""),v=g[0],b=g[1],h=(0,r.useState)(""),y=h[0],x=h[1],_=(0,r.useState)(!1),j=_[0],S=_[1],w=(0,i.I0)(),O=(0,i.v9)((function(e){return e.tendayweather})),Z=O.ids,E=O.status,k=O.entities,P=O.error;return(0,r.useEffect)((function(){null!==e&&(b(""),x(""),w((0,a.R)(e)))}),[e,w]),(0,r.useEffect)((function(){b(P)}),[P]),(0,r.useEffect)((function(){S(E===s.G.PENDING)}),[E]),(0,r.useEffect)((function(){if(b(""),x(""),E===s.G.FULLFILLED&&Z.length>0&&""===P&&null!==n){var e=Object.values(k).find((function(e){return e.municipality===n}));if(void 0!==e){var t,r,i=JSON.parse(e.data),a=Object.values(o.MW);p(i.reduce((function(e,n,o){var s,c,p;return u(e).concat([{id:o,label:n.day_format,label_full:null===(s=(0,l.Ay)(n.day_format,i[9].day_format))||void 0===s?void 0:s.toDateString(),rainfall:n.rainfall,forecast:null!==(t=null===(c=a.find((function(e){return e.tenday===n.rainfall})))||void 0===c?void 0:c.sync)&&void 0!==t?t:"-",code:null!==(r=null===(p=a.find((function(e){return e.tenday===n.rainfall})))||void 0===p?void 0:p.label)&&void 0!==r?r:"-"}])}),[]));var c=new Date(1e3*i[0].date_start.seconds),d=(0,l.Mn)(c);c.getFullYear(),(new Date).getFullYear();0,m({months:d,date_start:c,date_range:i[0].date_range})}else{var f=P||"Weather data for the municipality is not available at the moment, however, you can continue viewing recommendations. Please verify that the municipality name is present in the 10-Day weather forecast.";P?(p([]),m(null),b(f)):x(f)}}}),[n,k,Z,E,P]),{days:c,summary:f,loading:j,error:v,warning:y}}}},function(e){e.O(0,[5778,3593,9964,8858,1903,6279,542,7944,6295,1433,6572,1050,2044,7655,1855,9774,2888,179],(function(){return n=67947,e(e.s=n);var n}));var n=e.O();_N_E=n}]);