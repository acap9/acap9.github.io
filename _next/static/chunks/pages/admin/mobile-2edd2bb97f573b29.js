(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6503],{42604:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/mobile",function(){return t(57051)}])},70044:function(e,n){"use strict";n.Z={profileContainer:{display:"flex",flexDirection:"column",width:"100%"},profileCard:{padding:"22px",display:"flex",flexDirection:"column",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"15px",maxWidth:"600px",margin:"auto",borderColor:"#E2E8F0"},textfield:{marginTop:function(e){return e.spacing(3)}},button:{marginTop:function(e){return e.spacing(2)},width:"200px"}}},31338:function(e,n,t){"use strict";t.d(n,{x:function(){return c},P:function(){return u}});var r=t(85893),i=t(87357);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var c=function(e){var n=e.children,t=e.value,c=e.index,u=a(e,["children","value","index"]);return(0,r.jsx)("div",function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){o(e,n,t[n])}))}return e}({role:"tabpanel",hidden:t!==c,id:"custom-tabpanel-".concat(c),"aria-labelledby":"custom-tab-".concat(c)},u,{children:t===c&&(0,r.jsx)(i.Z,{sx:{p:3},children:n})}))};var u=function(e){return{id:"custom-tab-".concat(e),"aria-controls":"custom-tabpanel-".concat(e)}}},57051:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return de}});var r=t(85893),i=t(66383),o=t(95243),a=t(47426),c=t(34051),u=t.n(c),l=t(31338),s=t(38206),f=t(15861),d=t(87357),p=t(88409),v=t(40044),h=t(61903),b=t(94054),y=t(47312),x=t(18360),m=t(18972),O=t(37598),g=t(11057),j=t(98456),w=t(86886),I=t(67294),N=t(9473),S=t(56867),P=t(70044),_=t(57709),C=t(59334),T=t(69368);function Z(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function k(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],a=!0,c=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(u){c=!0,i=u}finally{try{a||null==t.return||t.return()}finally{if(c)throw i}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return Z(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Z(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var A={PaperProps:{style:{maxHeight:224,width:250}}};function E(e){var n=e.municipalities,t=e.setSelectedMun,i=k(I.useState([]),2),o=i[0],a=i[1];return(0,r.jsx)("div",{children:(0,r.jsxs)(b.Z,{sx:{mb:2,width:600},children:[(0,r.jsx)(y.Z,{id:"multiple-checkbox",children:"Municipality"}),(0,r.jsx)(x.Z,{labelId:"multiple-checkbox",id:"multiple-checkbox",multiple:!0,value:o,onChange:function(e){var n=e.target.value;a("string"===typeof n?n.split(","):n),t("string"===typeof n?n.split(","):n)},input:(0,r.jsx)(_.Z,{label:"Municipality"}),renderValue:function(e){return e.join(", ")},MenuProps:A,children:null===n||void 0===n?void 0:n.map((function(e){return(0,r.jsxs)(m.Z,{value:e,children:[(0,r.jsx)(T.Z,{checked:o.includes(e)}),(0,r.jsx)(C.Z,{primary:e})]},e)}))})]})})}var M=t(9669),R=t.n(M),F=t(99431),L=t(94763),D=t(83454);function U(e,n,t,r,i,o,a){try{var c=e[o](a),u=c.value}catch(l){return void t(l)}c.done?n(u):Promise.resolve(u).then(r,i)}function B(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){U(o,r,i,a,c,"next",e)}function c(e){U(o,r,i,a,c,"throw",e)}a(void 0)}))}}function V(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function W(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e,n,t){return n&&W(e.prototype,n),t&&W(e,t),e}function q(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function z(e){return z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},z(e)}function H(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&J(e,n)}function $(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){q(e,n,t[n])}))}return e}function G(e,n){return!n||"object"!==K(n)&&"function"!==typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function J(e,n){return J=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},J(e,n)}var K=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function Q(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=z(e);if(n){var i=z(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return G(this,t)}}var Y={BASE_API_URL:"https://amia-cis-9aoz.onrender.com/api",SAVE_NOTIFICATION:"".concat("https://amia-cis-9aoz.onrender.com/api","/notification"),SEND_NOTIFICATION_PROVINCIAL:"".concat(D.env.NEXT_PUBLIC_NOTIFICATION_URL,"/send-notification-by-province"),SEND_NOTIFICATION_MUNICIPAL:"".concat(D.env.NEXT_PUBLIC_NOTIFICATION_URL,"/send-notification-by-municipalities"),SEND_NOTIFICATION_PROVINCIAL_LOCAL:"http://localhost:5000/send-notification-by-province",SEND_NOTIFICATION_MUNICIPAL_LOCAL:"http://localhost:5000/send-notification-by-municipalities",SAVE_NOTIFICATION_LOCAL:"http://localhost:3001/api/notification"},ee=function(e){H(t,e);var n=Q(t);function t(){return V(this,t),n.apply(this,arguments)}return X(t,[{key:"saveNotificationMessage",value:function(e){var n=this;return B(u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"push_notifications",r=n.collection(n.db,"push_notifications"),t.next=4,n.addDoc(r,e);case 4:case"end":return t.stop()}}),t)})))()}}]),t}(L.Z),ne=function(e){H(t,e);var n=Q(t);function t(){return V(this,t),n.apply(this,arguments)}return X(t,[{key:"saveNotificationMessage",value:function(e){var n=this;return B(u().mark((function t(){var r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.createRequestObject({body:e});case 2:return r=t.sent,t.next=5,R()($({},r,{url:Y.SAVE_NOTIFICATION,method:"POST"}));case 5:return i=t.sent,t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t)})))()}},{key:"sendNotificationMessageProvincial",value:function(e){var n=this;return B(u().mark((function t(){var r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.createRequestObjectNotif({body:e});case 2:return r=t.sent,t.next=5,R()($({},r,{url:Y.SEND_NOTIFICATION_PROVINCIAL,method:"POST"}));case 5:return i=t.sent,t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t)})))()}},{key:"sendNotificationMessageMunicipal",value:function(e){var n=this;return B(u().mark((function t(){var r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.createRequestObjectNotif({body:e});case 2:return r=t.sent,t.next=5,R()($({},r,{url:Y.SEND_NOTIFICATION_MUNICIPAL,method:"POST"}));case 5:return i=t.sent,t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t)})))()}}]),t}(F.Z),te=new ne,re=new ee,ie=re.saveNotificationMessage.bind(re),oe=te.sendNotificationMessageMunicipal.bind(te),ae=te.sendNotificationMessageProvincial.bind(te),ce=t(8465);function ue(e,n,t,r,i,o,a){try{var c=e[o](a),u=c.value}catch(l){return void t(l)}c.done?n(u):Promise.resolve(u).then(r,i)}function le(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function se(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){le(e,n,t[n])}))}return e}var fe=function(){var e=(0,N.I0)(),n=(0,I.useState)(0),t=n[0],i=n[1],o=(0,I.useState)(null),a=o[0],c=o[1],_=(0,I.useState)(null),C=_[0],T=_[1],Z=(0,I.useState)([]),k=Z[0],A=Z[1],M=(0,I.useState)(null),R=M[0],F=M[1],L=(0,I.useState)(null),D=L[0],U=L[1],B=(0,I.useState)(null),V=B[0],W=B[1],X=(0,I.useState)([]),q=X[0],z=X[1],H=(0,I.useState)(!1),$=H[0],G=H[1],J=(0,I.useState)(!1),K=J[0],Q=J[1],Y=(0,I.useState)(null),ee=Y[0],ne=Y[1],te=(0,N.v9)((function(e){return e.provinces})),re=te.ids,le=te.municipalities;(0,I.useEffect)((function(){if(0!==re.length||0!==le.length){var e=Object.keys(le);A(e)}}),[e,le,re.length]),(0,I.useEffect)((function(){null!==R&&W(le[R].map((function(e){return e.label})))}),[R,e,le]);var fe=function(){var e,n=(e=u().mark((function e(){var n,t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G(!0),(n={title:C,body:a,province:R,municipalities:q||void 0,deliveryType:D,date_created:Math.floor(Date.now()/1e3)}).title&&n.body&&n.province){e.next=6;break}return console.warn("INFO: Missing parameters!"),G(!1),e.abrupt("return");case 6:if(e.prev=6,"municipal"!==D){e.next=15;break}return e.next=11,oe(n);case 11:t=e.sent,console.log("Mun:",t),e.next=20;break;case 15:if("provincial"!==D){e.next=20;break}return e.next=18,ae(n);case 18:t=e.sent,console.log("Prov",t);case 20:if(!t.success){e.next=26;break}return e.next=23,ie(n);case 23:ne("Notification sent!"),e.next=27;break;case 26:console.warn("ERROR: Message not save"),ne("Notification not archived!");case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(6),console.warn("ERROR: Error sending push notification!",e.t0),ne("Error sending push notification!");case 33:return e.prev=33,G(!1),Q(!0),e.finish(33);case 37:case"end":return e.stop()}}),e,null,[[6,29,33,37]])})),function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){ue(o,r,i,a,c,"next",e)}function c(e){ue(o,r,i,a,c,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,r.jsxs)("div",{children:[(0,r.jsx)(ce.Z,{open:K,autoHideDuration:3e3,onClose:function(e,n){"clickaway"!==n&&Q(!1)},children:(0,r.jsx)(s.Z,{style:{backgroundColor:"white",color:"blue"},message:(0,r.jsxs)("span",{id:"client-snackbar",children:[" ",ee," "]})})}),(0,r.jsx)(f.Z,{variant:"h5",children:"Mobile App Management"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:" Trigger push notifications"})," of generated Crop Recommendations, Weather Updates and send them to different individuals via Mobile Application."]}),(0,r.jsx)(d.Z,{sx:P.Z.tabsContainer,children:(0,r.jsxs)(d.Z,{sx:P.Z.tabsContainer,children:[(0,r.jsx)(p.Z,{value:t,onChange:function(e,n){i(n)},"aria-label":"Tabs",children:(0,r.jsx)(v.Z,se({label:"Send Notification"},(0,l.P)(0)))}),(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(l.x,{value:t,index:0,children:(0,r.jsxs)(d.Z,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:[(0,r.jsx)(h.Z,{id:"outlined-basic",label:"Notification title",variant:"outlined",sx:{width:600,mb:2},onChange:function(e){T(e.target.value)}}),(0,r.jsxs)(b.Z,{sx:{width:600,mb:2},children:[(0,r.jsx)(y.Z,{id:"delivery-type",children:" Delivery Type "}),(0,r.jsxs)(x.Z,{labelId:"delivery-type",id:"delivery-type",value:D,label:"Delivery Type",onChange:function(e){U(e.target.value)},children:[(0,r.jsx)(m.Z,{value:"provincial",children:"Send notification by province"}),(0,r.jsx)(m.Z,{value:"municipal",children:"Send notification by municipality"})]})]}),(0,r.jsxs)(b.Z,{sx:{width:600,mb:2},children:[(0,r.jsx)(y.Z,{id:"select-province",children:" Select Province "}),(0,r.jsx)(x.Z,{labelId:"select-province",id:"select-province",value:R,label:"Select Province",onChange:function(n){F(n.target.value),e((0,S.R)(n.target.value))},children:null===k||void 0===k?void 0:k.map((function(e,n){return(0,r.jsxs)(m.Z,{value:e,children:[" ",e," "]},n)}))})]}),"municipal"===D&&(0,r.jsx)(E,{municipalities:V,setSelectedMun:z}),(0,r.jsx)(O.Z,{"aria-label":"minimum height",minRows:10,placeholder:"Notification body",style:{width:600},onChange:function(e){c(e.target.value)}}),(0,r.jsx)(g.Z,{onClick:fe,disabled:$,variant:"contained",sx:{width:300,m:2},children:!0===$?(0,r.jsxs)(r.Fragment,{children:[" Sending...",(0,r.jsx)(j.Z,{color:"secondary"})," "]}):"Send Notification"})]})}),(0,r.jsx)(l.x,{value:t,index:1,children:(0,r.jsx)(w.ZP,{container:!0,children:(0,r.jsx)(w.ZP,{item:!0,xs:12,md:4})})})]})]})})]})};var de=(0,o.Z)((function(e){return(0,r.jsx)(i.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:a.DW.ADMIN,children:(0,r.jsx)(fe,{})})}))}},function(e){e.O(0,[5778,3593,9964,6002,1903,6279,7530,8465,6572,2460,1050,9774,2888,179],(function(){return n=42604,e(e.s=n);var n}));var n=e.O();_N_E=n}]);